<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Securly Policy Dump (Viewer)</title>
<style>
  :root { color-scheme: light dark; }
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol'; margin: 0; background:#0b1020; color:#e8eef9; }
  .wrap { max-width: 1100px; margin: 32px auto; padding: 0 16px; }
  .card { background: #0f1730; border: 1px solid #253058; border-radius: 14px; box-shadow: 0 10px 24px rgba(0,0,0,.25); }
  .row { display: grid; grid-template-columns: 1fr auto; gap: 12px; }
  h1 { font-size: 20px; margin: 0 0 6px; }
  p.hint { margin: 0 0 14px; color:#9fb1d8; font-size: 13px; }
  .toolbar { display: flex; flex-wrap: wrap; gap: 8px; align-items: center; padding: 14px; border-bottom: 1px solid #253058;}
  .toolbar input[type="text"]{ flex:1 1 280px; min-width: 240px; border-radius: 10px; padding:10px 12px; border:1px solid #2b3b6d; background:#0b1328; color:#e8eef9; }
  .toolbar label { font-size: 13px; color:#c6d4f4; display:flex; align-items:center; gap:8px; }
  .toolbar input[type="checkbox"]{ transform: translateY(1px); }
  .toolbar button{ background:#3b82f6; color:white; border:0; border-radius:10px; padding:10px 14px; font-weight:600; cursor:pointer; }
  .toolbar button:hover{ background:#2563eb; }
  .toolbar .copy{ background:#475569; }
  .toolbar .copy:hover{ background:#334155; }
  .summary { padding: 14px; display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap: 12px; }
  .pill { background:#151f3c; border:1px solid #2b3b6d; border-radius:10px; padding:10px 12px; font-size:13px; color:#c6d4f4; }
  .keys { padding: 0 14px 14px; }
  .keys h3{ font-size:13px; color:#9fb1d8; margin: 0 0 8px; }
  .keys ul{ list-style: none; margin:0; padding:0; display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:8px;}
  .keys li{ font-size:12px; background:#0b1328; border:1px solid #253058; border-radius:10px; padding:8px 10px; color:#c6d4f4; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;}
  .viewer { margin-top: 16px; }
  pre { margin: 0; padding: 14px; background:#0b1328; border-top:1px solid #253058; border-bottom-left-radius:14px; border-bottom-right-radius:14px; overflow:auto; max-height: 65vh; white-space: pre; }
  .muted { color:#9fb1d8; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="toolbar">
        <div style="flex:1 1 auto; min-width:300px">
          <h1>Securly Policy Dump (Viewer)</h1>
          <p class="hint">Shows cached data from <code>chrome.storage.local</code> used by the extension. Nothing is downloaded.</p>
        </div>
        <button id="btn-refresh" title="Read storage and render">Show Policy Data</button>
      </div>

      <div class="toolbar" style="border-top:0">
        <input id="filter" type="text" placeholder="Filter keys (regex). e.g. (policy|filter|config|user|list|settings)" />
        <label><input id="showAll" type="checkbox" /> Show all keys</label>
        <button id="btn-copy" class="copy" title="Copy JSON to clipboard">Copy JSON</button>
      </div>

      <div id="status" class="muted" style="padding: 0 14px 10px;"></div>

      <div class="summary" id="summary">
        <div class="pill" id="pill-keys">Keys: —</div>
        <div class="pill" id="pill-size">JSON Size: —</div>
        <div class="pill" id="pill-time">Refreshed: —</div>
      </div>

      <div class="keys">
        <h3>Matched Keys</h3>
        <ul id="keylist"><li class="muted">Nothing loaded yet.</li></ul>
      </div>

      <div class="viewer">
        <pre id="json"> </pre>
      </div>
    </div>
  </div>

  <!-- MV3 blocks inline scripts; load from a separate file -->
  <script src="dump_view.js"></script>
</body>
</html>
